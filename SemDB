/**
 * 
 */

/**
 * 
 */
public class SemDB {
    
    private HashTable table;
    private MemoryManager mem;
    
    public SemDB(int initialMemorySize, int initialHashSize) {
        
        int memSize = initialMemorySize;
        int hashSize = initialHashSize;
        
        table = new HashTable(hashSize);
        mem = new MemoryManager(memSize);
   
    }
    
    public void add(int id, Seminar sem) throws Exception {
        //call the insert methods for memManager and hashtable
        byte[] x = sem.serialize();
        
        Handle identifier = mem.getHandle(x, x.length);
        
        
        boolean result = table.insert(id, sem, identifier);
        if (result == true) {
            
            mem.insert(x, x.length);
            
        }
 
    }
    
    public void remove(int key) {
        
        //retrieve the handle associated with the key
        Handle thisHandle = table.returnHandle(key);
        
        boolean result = table.delete(key);
        if (result == true) {
            mem.remove(thisHandle);
        }
        
    }
    
    public void search(int key) {
        
        table.search(key);
        
    }
    
    public void print(String text) {
        
        boolean result = table.print(text);
        
        if (result == true) {
            mem.dump();
        }
        
    }

}
